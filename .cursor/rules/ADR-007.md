# ADR-007: Agent Activity Simulation and Monitoring Integration
Status: Accepted
Date: 2025-08-31

## Context
- Agent swarm requires OPENAI_API_KEY for actual AI communication, limiting development/testing without API costs
- Adaptive monitoring system (ADR-005) needs realistic agent activity to validate all functionality
- Need ability to demonstrate and test agent workflows without external API dependencies
- Activity detection hooks integrated into memory tools but need comprehensive validation

## Decision
- **Agent Activity Simulation**: Create simulation framework that generates realistic agent activity patterns without requiring OPENAI_API_KEY
- **Development Cycle Demo**: Implement complete Father→Architect→Developer→QA→Reviewer→Father workflow simulation
- **Monitoring Integration**: Bridge activity detection between simulation and monitoring systems
- **Validation Suite**: Comprehensive testing of all 4 activity levels (idle→low→medium→high)

### Implementation Components
1. `scripts/demo-agent-activity.py` - Realistic agent workflow simulation
2. `scripts/validate-monitoring.py` - Comprehensive monitoring validation suite
3. Enhanced activity detection hooks in memory tools
4. Flow activity recording for agent-to-agent handoffs

### Activity Simulation Patterns
- **Agent Thinking**: start→memory_read→complete lifecycle
- **Memory Operations**: Both WriteMemory and ReadMemoryContext tool usage
- **Flow Handoffs**: Proper flow_start/flow_complete with task delegation
- **Multi-Agent Coordination**: Realistic timing and interaction patterns

## Alternatives
- Mock agency_swarm completely (too complex, loses integration benefits)
- Require OPENAI_API_KEY for all development (expensive, external dependency)
- Simple unit tests only (insufficient for end-to-end validation)

## Consequences
- **Positive:**
  - Development and testing possible without OPENAI_API_KEY
  - Complete validation of adaptive monitoring system
  - Realistic demonstration of agent workflows
  - Stress testing capabilities (97 ops/10s validated)
  - Beautiful Rich UI rendering confirmed working
  
- **Negative:**
  - Simulation may not capture all edge cases of real AI agent behavior
  - Additional maintenance overhead for simulation logic
  
- **Security/Privacy impact:**
  - No external API calls eliminates data leakage concerns
  - Simulation runs entirely locally with no network dependencies
  
- **Migration plan:**
  - Simulation coexists with real agent system
  - When OPENAI_API_KEY available, real agents can be used alongside simulation
  - Activity detection works identically for both simulated and real agents

## Verification
- **Tests added/updated:**
  - `scripts/validate-monitoring.py` - 7 comprehensive validation tests
  - All activity levels (idle/low/medium/high) validated
  - UI rendering and integration tests included
  - Stress test with 10+ operations per second confirmed
  
- **Metrics/alerts:**
  - Activity detection accuracy: 100% (7/7 tests passed)
  - UI rendering stability: Confirmed with complex mock data
  - Performance: Handles 97 operations in 10 seconds with 102 events tracked
  - Memory integration: WriteMemory and ReadMemoryContext tools working

## Demo Usage
```bash
# Run agent activity simulation
PYTHONPATH=/Users/am/Code/Fresh poetry run python scripts/demo-agent-activity.py

# Validate monitoring system
PYTHONPATH=/Users/am/Code/Fresh poetry run python scripts/validate-monitoring.py

# Start adaptive monitoring (shows beautiful Rich UI)
PYTHONPATH=/Users/am/Code/Fresh poetry run python scripts/watch-agents-adaptive.py
```

## Success Metrics
✅ **All validation tests passing**
✅ **Complete development cycle simulation working**  
✅ **Adaptive monitoring responding to activity levels**
✅ **Rich UI rendering correctly**
✅ **Memory system integration functional**

This ADR enables full development and validation of the agent monitoring system independent of external API requirements.
