# ADR-001: Adopt Agency Swarm for multi-agent orchestration with TDD and ADR gates
Status: Accepted
Date: 2025-08-28

## Context
- We need a reliable, production-ready agent framework with role flows, typed tools, and state management.
- Prior repos became messy: no tests first, weak decision records, and ad-hoc orchestration.
- Agency Swarm ("Reliable agent framework built on top of OpenAI Assistants API"; see README) offers:
  - Customizable roles and directional communication via `Agency([...])`.
  - Type-safe tools (Pydantic) and state management (`settings.json`).

## Decision
- Use Agency Swarm for orchestration (Architect → Developer → QA → Reviewer → Architect loop).
- Enforce TDD-first and ADR discipline in both rules and CI:
  - Tests must be added/changed when source changes (`scripts/check-tests-changed.sh`).
  - CI requires tests to pass.
  - PRs must reference an ADR (ADR-XXX) (adr-check workflow).
- Keep secrets local; `.env` never committed.

## Alternatives
- Custom orchestration using plain OpenAI SDK — faster start, but more glue code and less safety.
- Other agent frameworks — evaluated periodically; adapter layer keeps migration feasible.

## Consequences
- Positive: Clear roles, safer changes, reproducible workflows, easy scaling of agents/tools.
- Negative: Python/Poetry dependency; OpenAI Assistants API requirement.
- Security/Privacy impact: No secrets in VCS; state files ignored by `.gitignore`.
- Migration plan: If needed, rewrite `ai/agency.py` and `ai/tools/*` adapters while keeping tests stable.

## Verification
- tests pass (`scripts/run-tests.sh`).
- CI gates enforce tests & ADR.
- New ADRs created via `CreateADR` tool increment numbering and include boilerplate sections.

